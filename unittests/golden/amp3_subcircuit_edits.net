*Three stage operational amplifier

*** *** OPAMP SUBCIRCUIT *** ***
.SUBCKT PFC.SUB VP VN VOUT IBIAS VB1 AVDD AVSS

M00 IBIAS IBIAS AVDD AVDD PMOS W=0.000025175 L=0.000003675

* differential pair
M10 1     IBIAS AVDD AVDD PMOS W=0.000025175 L=0.000003675 M=6

M11 2     VN    1    1    PMOS W=5.035E-05 L=3.675e-06
M12 3     VP    1    1    PMOS W=0.000025175 L=0.000003675

* folded cascode
M13 4     IBIAS AVDD AVDD PMOS W=0.000025175 L=0.000003675 M=3
M16 5     IBIAS AVDD AVDD PMOS W=0.000025175 L=0.000003675 M=3

M14 4     VB1   2    AVSS NMOS W=0.000025175 L=0.000003675
M17 5     VB1   3    AVSS NMOS W=0.000025175 L=0.000003675

M15 2     4     AVSS AVSS NMOS W=0.000025175 L=0.000003675
M18 3     4     AVSS AVSS NMOS W=0.000025175 L=0.000003675

* second stage
M20 6     5     AVDD AVDD PMOS W=0.000025175 L=0.000003675
M22 7     IBIAS AVDD AVDD PMOS W=0.000025175 L=0.000025175

M21 6     6     AVSS AVSS NMOS W=0.000025175 L=0.000003675
M23 7     6     AVSS AVSS NMOS W=0.000025175 L=0.000003675

* third stage
M30 VOUT  5     AVDD AVDD PMOS W=0.000025175 L=0.000003675 M=22
M31 VOUT  7     AVSS AVSS NMOS W=0.000025175 L=0.000003675 M=5

* compensation
CM1 5 VOUT 0.000000000010999999999999999
CM2 5 7    0.000000000010999999999999999
.ENDS PFC.SUB

*** *** SUPPLY VOLTAGES *** ***
VDD VDD 0 2.8499999999999996
VSS VSS 0   0

*** *** BIAS VOLTAGE *** ***
VVB1 VB1 VSS DC 2.0

*** *** BIAS CURRENT *** ***
IIBIAS IBIAS VSS 0.0000055

*** *** SUB-CIRCUIT *** ***
XOPAMP VP VN VOUT IBIAS VB1 VDD VSS PFC.SUB

*** *** LOAD *** ***
RL VOUT VX 10k
CL VOUT VX 100p
VX VX VSS '2.8499999999999996/2'

*** *** AC LOOP *** ***
VIN VP VSS '2.8499999999999996/2' AC 1
RX  VN VOUT 1m AC=1E12
CX  VN VSS 10

*** *** ANALYSIS *** ***
.AC DEC 100 0.001 1E9
*.PZ V(VOUT)
.PROBE AC VDB(VOUT)
.PROBE AC VP(VOUT)
.OP
* .OPTION NOBOUND_PHASE
.INCLUDE p.typ
.INCLUDE n.typ
.END
